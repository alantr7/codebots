
define_func location
begin
  define_var x
  unload_arg 0 x
  define_var y
  unload_arg 1 y
  define_var z
  unload_arg 2 z
  define_var array
  push_stack
  push_func array 1
  set $exp1 3
  set_arg 0 $exp1
  call
  push $rv
  pop_func
  eval array pop
  pop_stack

  set $cs #this_module
  push_stack
  set $cs #this_module
  push *x
  eval $exp3 pop
  pop_stack
  set $exp1 *array
  set $exp2 0
  array_set $exp1 $exp2 $exp3


  set $cs #this_module
  push_stack
  set $cs #this_module
  push *y
  eval $exp3 pop
  pop_stack
  set $exp1 *array
  set $exp2 1
  array_set $exp1 $exp2 $exp3


  set $cs #this_module
  push_stack
  set $cs #this_module
  push *z
  eval $exp3 pop
  pop_stack
  set $exp1 *array
  set $exp2 2
  array_set $exp1 $exp2 $exp3

  push_stack
  set $cs #this_module
  push *array
  eval $rv pop
  pop_stack
  exit_func
end
define_func main
begin
  define_var locations
  push_stack
  push_func dict 0
  call
  push $rv
  pop_func
  eval locations pop
  pop_stack

  set $cs #this_module
  push_stack
  push_func location 3
  set $exp1 12
  set_arg 0 $exp1
  set $exp1 20
  set_arg 1 $exp1
  set $exp1 12
  set_arg 2 $exp1
  call
  push $rv
  pop_func
  eval $exp3 pop
  pop_stack
  set $exp1 *locations
  set $exp2 "home"
  array_set $exp1 $exp2 $exp3


  set $cs #this_module
  push_stack
  push_func location 3
  set $exp1 123
  set_arg 0 $exp1
  set $exp1 20
  set_arg 1 $exp1
  set $exp1 456
  set_arg 2 $exp1
  call
  push $rv
  pop_func
  eval $exp3 pop
  pop_stack
  set $exp1 *locations
  set $exp2 "farm"
  array_set $exp1 $exp2 $exp3

  push_func print 1
  push_stack
  push "Home's X is: "
  set $cs #this_module

  set $cs #this_module
  set $exp1 *locations
  set $exp2 "home"
  array_get $exp1 $exp2 $exp1
  set $exp2 0
  array_get $exp1 $exp2 $exp1
  push $exp1

  eval $exp1 pop pop +
  pop_stack
  set_arg 0 $exp1
  call
  pop_func
  push_func dict_unset 2
  push_stack
  set $cs #this_module
  push *locations
  eval $exp1 pop
  pop_stack
  set_arg 0 $exp1
  set $exp1 "farm"
  set_arg 1 $exp1
  call
  pop_func
  push_func print 1
  push_stack
  push "Farm is now at: "
  set $cs #this_module

  set $cs #this_module
  set $exp1 *locations
  set $exp2 "farm"
  array_get $exp1 $exp2 $exp1
  push $exp1

  eval $exp1 pop pop +
  pop_stack
  set_arg 0 $exp1
  call
  pop_func
  push_func print 1
  push_stack
  push "There are "
  push_func length 1
  push_stack
  set $cs #this_module
  push *locations
  eval $exp1 pop
  pop_stack
  set_arg 0 $exp1
  call
  push $rv
  pop_func
  push " locations saved."
  eval $exp1 pop pop + pop +
  pop_stack
  set_arg 0 $exp1
  call
  pop_func
end
